// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Vendedor {
  id         String              @id @default(uuid())
  nome       String              @unique
  cargo      String // JUNIOR ou PLENO
  vendas     Venda[]
  relatorios RelatoriosDiarios[]
  createdAt  DateTime            @default(now())
  updatedAt  DateTime            @updatedAt
}

model Venda {
  id         String   @id @default(uuid())
  vendedorId String
  vendedor   Vendedor @relation(fields: [vendedorId], references: [id], onDelete: Cascade)
  data       DateTime
  nome       String
  email      String
  valor      Float
  status     String // CONFIRMADA, PENDENTE, ESTORNADA
  cupom      String? // Cupom usado na venda
  plano      String? // ANUAL ou VITALICIO
  observacao String?
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  @@index([vendedorId])
  @@index([data])
  @@index([status])
}

model RelatoriosDiarios {
  id                String   @id @default(uuid())
  vendedorId        String
  vendedor          Vendedor @relation(fields: [vendedorId], references: [id], onDelete: Cascade)
  data              DateTime
  leadsRecebidos    Int
  respostasEnviadas Int
  vendas            Int
  observacao        String?
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  @@unique([vendedorId, data])
  @@index([vendedorId])
  @@index([data])
}

model PlanoCarreira {
  id           String   @id @default(uuid())
  cargo        String // JUNIOR, PLENO, SENIOR, GERENTE
  salarioFixo  Float
  percentuais  String // JSON array: [0.02, 0.03, 0.04, 0.05]
  dataVigencia DateTime // Data a partir da qual este plano entra em vigor
  ativo        Boolean  @default(true)
  observacao   String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@index([cargo])
  @@index([dataVigencia])
  @@index([ativo])
}
